<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pokemon Info</title>
</head>

<body>

    <h1 id="name" data-id=""></h1>
    <img id="sprite" src="" alt="Pokemon Sprite" />
    <div>Height: <span id="height"></span></div>
    <div>Weight: <span id="weight"></span></div>
    <div>Types: <span id="types"></span></div>
    <div>Abilities: <span id="abilities"></span></div>
    <div id="stats"></div>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const name = urlParams.get("name");

        function updatePokemonInfo(data) {
            const id = data.id;
            const height = data.height;
            const weight = data.weight;
            const types = data.types
                .map((typeInfo) => {
                    const typeName = typeInfo.type.name;
                    return `<a href="type.html?type=${typeName}">${typeName}</a>`;
                })
                .join(" ");
            const abilities = data.abilities
                .map((abilityInfo) => {
                    const abilityName = abilityInfo.ability.name;
                    return `<a href="ability.html?ability=${abilityName}">${abilityName}</a>`;
                })
                .join(" ");
            const stats = data.stats
                .map((statInfo) => {
                    const statName = statInfo.stat.name;
                    const statValue = statInfo.base_stat;
                    return `<div>${statName}: ${statValue}</div>`;
                })
                .join("");
            const spriteUrl = `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${id}.png`;

            document.getElementById("sprite").src = spriteUrl;

            const nameElement = document.getElementById("name");
            nameElement.innerText = data.name;
            nameElement.dataset.id = id;

            document.getElementById("height").innerText = `${height / 10} meters`; // height in meters
            document.getElementById("weight").innerText = `${weight / 10} kg`; // weight in kilograms
            document.getElementById("types").innerHTML = types;
            document.getElementById("abilities").innerHTML = abilities;
            document.getElementById("stats").innerHTML = stats;
        }

        if (name) {
            fetch(`https://pokeapi.co/api/v2/pokemon/${name.toLowerCase()}`)
                .then(res => res.json())
                .then(data => updatePokemonInfo(data))
                .catch(err => console.error("Error fetching Pokémon data:", err));
        } else {
            document.getElementById("name").innerText = "No Pokémon name provided in query parameter.";
        }
    </script>
</body>

</html>